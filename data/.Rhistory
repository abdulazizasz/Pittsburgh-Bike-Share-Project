getwd()
setwd("./Documents/Master/Data Mining/Project/Pittsburgh-Bike-Share-Project")
### Get the data
setwd("./data/")
library(lubridate)
library(dplyr)
library(lubridate)
library(dplyr)
## Read The data
### stations data
stations <- read.csv("HealthyRideStations2015.csv")
## 2015 Q3
rentalQ153 <- read.csv("HealthyRideRentals 2015 Q3.csv",na.strings= c("999", "NA", " ", ""))
### Change the data
rentalQ153$StartTime <- strptime(rentalQ153$StartTime, format="%m/%d/%Y %H:%M")
rentalQ153$StopTime <- strptime(rentalQ153$StopTime, format="%m/%d/%Y %H:%M")
# rentalQ153$StartTime <- as.POSIXct(rentalQ153$StartTime, format="%m/%d/%Y %H:%M")
# rentalQ153$StopTime <- as.POSIXct(rentalQ153$StopTime, format="%m/%d/%Y %H:%M")
## 2015 Q4
## Converting from xls to csv
# require(gdata)
# ## install support for xlsx files
# installXLSXsupport()
# excelFile <- ("./HealthyRideRentals 2015 Q4.xlsx")
# ## note that the perl scripts that gdata uses do not cope well will tilde expansion
# ## on *nix machines. So use the full path.
# numSheets <- sheetCount(excelFile, verbose=TRUE)
#
# for ( i in 1:numSheets) {
#   mySheet <- read.xls(excelFile, sheet=i)
#   write.csv(mySheet, file=paste(i, "csv", sep="."), row.names=FALSE)
# }
rentalQ154 <- read.csv("HealthyRideRentals 2015 Q4.csv", na.strings= c("999", "NA", " ", ""))
rentalQ154$StartTime <- strptime(rentalQ154$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ154$StopTime <- strptime(rentalQ154$StopTime, format="%Y-%m-%d %H:%M:%S")
# rentalQ154$StartTime <- as.POSIXct(rentalQ154$StartTime)
# rentalQ154$StopTime <- as.POSIXct(rentalQ154$StopTime)
## 2016 Q1
## Converting from xls to csv
# require(gdata)
# ## install support for xlsx files
# installXLSXsupport()
# excelFile <- ("./HealthyRide Rentals 2016 Q1.xlsx")
# ## note that the perl scripts that gdata uses do not cope well will tilde expansion
# ## on *nix machines. So use the full path.
#
#
# mySheet <- read.xls(excelFile)
# write.csv(mySheet, file=paste("HealthyRide Rentals 2016 Q1","csv", sep="."), row.names=FALSE)
rentalQ161 <- read.csv("HealthyRide Rentals 2016 Q1.csv", na.strings= c("999", "NA", " ", ""))
## Make sure they have the same colunm names
names(rentalQ161) <- c(names(rentalQ153))
rentalQ161$StartTime <- strptime(rentalQ161$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ161$StopTime <- strptime(rentalQ161$StopTime, format="%Y-%m-%d %H:%M:%S")
# rentalQ161$Starttime <- as.POSIXct(rentalQ161$Starttime,format="%Y-%m-%d %H:%M:%S")
# rentalQ161$Stoptime <- as.POSIXct(rentalQ161$Stoptime,format="%Y-%m-%d %H:%M:%S")
## binding the data together
bike <- rbind(rentalQ153,rentalQ154,rentalQ161)
bike$TripId <- as.factor(bike$TripId)
bike$BikeId <- as.factor(bike$BikeId)
bike$FromStationId <- as.factor(bike$FromStationId)
bike$ToStationId <- as.factor(bike$ToStationId)
## Splitting the date
# bike <- bike %>% mutate(
#   year = format(as.POSIXct(StartTime), format = "%Y"),
#   month = format(as.POSIXct(StartTime), format = "%m"),
#   day = format(as.POSIXct(StartTime), format = "%d"),
#   hour = format(as.POSIXct(StartTime), format= "%H")
# )
set_up_features <- function(df) {
df$StartTime <- strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$StartTime$hour)
df$day <-  as.factor(df$StartTime$mday)
df$wday <- as.factor(df$StartTime$wday)
df$month <- as.factor(df$StartTime$mon+1) ## starts from 0
df$year <- as.factor(df$StartTime$year + 1900)
df
}
bike <- set_up_features(bike)
## Make a summeary for the missing values
na_data <- sapply(bike, function(x) sum(length(which(is.na(x)))))
na_data
bike$FromStationName[which(is.na(bike$FromStationId))]
bike$FromStationId[which(is.na(bike$FromStationName))]
## I guss we should just drop them
bike %>% select(TripId,day, month) %>% filter(day==1, month == 7)
newBike <- bike %>% select(TripId,day, month) %>% filter(day==1, month == 7)
View(newBike)
sum(is.na(newBike))
View(bike)
newBike <- bike %>% select(TripId,day, month, hour) %>% filter(day==1, month == 7) %>% group_by(hour)
View(newBike)
newBike <- bike %>%
select(TripId,day, month, hour) %>%
filter(day==1, month == 7) %>%
group_by(hour) %>%
summarise(total = n())
View(newBike)
newBike <- bike %>%
group_by(hour) %>%
summarise(total = n())
newBike <- bike %>%
select(TripId,day, month, hour) %>%
filter(day==1, month == 7) %>%
group_by(hour) %>%
summarise(total = n())
View(newBike)
newBike <- bike %>%
select(TripId,day, month, hour) %>%
filter(day==1, month == 7) %>%
group_by(hour,TripId) %>%
summarise(total = n())
View(newBike)
View(rentalQ153)
View(rentalQ154)
View(rentalQ161)
## Make a summeary for the missing values
na_data <- sapply(bike, function(x) sum(length(which(is.na(x)))))
na_data
length(na_data)
sum(is.na(bike))
View(newBike)
newBike <- bike %>%
select(TripId,day, month, hour) %>%
filter(day==1, month == 7) %>%
group_by(hour) %>%
summarise(total = n())
View(newBike)
View(rentalQ153)
View(rentalQ154)
View(rentalQ161)
`823948` <- read.csv("~/Downloads/823948.csv", header=FALSE)
View(`823948`)
`823950` <- read.csv("~/Downloads/823950.csv", header=FALSE)
View(`823950`)
`1` <- read.csv("~/Desktop/1.csv", header=FALSE)
View(`1`)
AAA <- read.table("/var/folders/b6/6v6f702x2yqbt97h2b468t100000gn/T//RtmpZqYbZX/data3d21f7c2936", quote="\"", comment.char="")
View(AAA)
remove(1)
remove(1)
View(`1`)
View(bike)
bike$StartTime
bike$StartTime[1]
bike$StartTime[1]$year
bike$StartTime[1]$year + 1900
bike %>% select(StartTime)
%>% mutate( holiday = bike$StartTime$year )
newBike <-bike %>% select(StartTime)
%>% mutate( holiday = bike$StartTime$year )
View(bike)
bike$holiday <
bike$holiday
holiday
bike$StartTime[1]$year + 1900
bike$StartTime[1]$day
bike$StartTime[1]$mday
bike$StartTime[1]$mday
View(stations)
View(stations)
