#
# mySheet <- read.xls(excelFile)
# write.csv(mySheet, file=paste("HealthyRide Rentals 2016 Q1","csv", sep="."), row.names=FALSE)
rentalQ161 <- read.csv("HealthyRide Rentals 2016 Q1.csv", na.strings= c("999", "NA", " ", ""))
rentalQ161$Starttime <- as.POSIXct(rentalQ161$Starttime,format="%Y-%m-%d %H:%M:%S")
rentalQ161$Stoptime <- as.POSIXct(rentalQ161$Stoptime,format="%Y-%m-%d %H:%M:%S")
## Make sure they have the same colunm names
names(rentalQ161) <- c(names(rentalQ153))
## binding the data together
bike <- rbind(rentalQ153,rentalQ154,rentalQ161)
bike$TripId <- as.factor(bike$TripId)
bike$BikeId <- as.factor(bike$BikeId)
bike$FromStationId <- as.factor(bike$FromStationId)
bike$ToStationId <- as.factor(bike$ToStationId)
## Splitting the date
bike <- bike %>% mutate(
year = format(as.POSIXct(StartTime), format = "%Y"),
month = format(as.POSIXct(StartTime), format = "%m"),
day = format(as.POSIXct(StartTime), format = "%d"),
hour = format(as.POSIXct(StartTime), format= "%H")
)
## Make a summeary for the missing values
na_data <- sapply(bike, function(x) sum(length(which(is.na(x)))))
na_data
bike$FromStationName[which(is.na(bike$FromStationId))]
bike$FromStationId[which(is.na(bike$FromStationName))]
grep("NA", bike$FromStationId)
grep("NA", bike$FromStationId)
grep("NA", bike)
na_data
bike$TripId[which(is.na(bike$TripDuration))]
View(bike)
View(rentalQ153)
sum(is.na(bike))
66000 - 5624
66000 - 60367
66000 - 60376
View(stations)
## Read The data
### stations data
stations <- read.csv("HealthyRideStations2015.csv")
## 2015 Q3
rentalQ153 <- read.csv("HealthyRideRentals 2015 Q3.csv",na.strings= c("999", "NA", " ", ""))
### Change the data
# rentalQ153$StartTime <- as.POSIXct(rentalQ153$StartTime, format="%m/%d/%Y %H:%M")
# rentalQ153$StopTime <- as.POSIXct(rentalQ153$StopTime, format="%m/%d/%Y %H:%M")
View(rentalQ153)
rentalQ153$StartTime <- strptime(rentalQ153$StartTime, format="%m/%d/%Y %H:%M:%S")
rentalQ153 <- read.csv("HealthyRideRentals 2015 Q3.csv",na.strings= c("999", "NA", " ", ""))
rentalQ153$StartTime <- strptime(rentalQ153$StartTime, format="%m/%d/%Y %H:%M")
rentalQ153$StartTime <- strptime(rentalQ153$StartTime, format="%m/%d/%Y %H:%M")
rentalQ153$StopTime <- strptime(rentalQ153$StopTime, format="%m/%d/%Y %H:%M")
rentalQ153 <- read.csv("HealthyRideRentals 2015 Q3.csv",na.strings= c("999", "NA", " ", ""))
rentalQ153$StartTime <- strptime(rentalQ153$StartTime, format="%m/%d/%Y %H:%M")
rentalQ153$StopTime <- strptime(rentalQ153$StopTime, format="%m/%d/%Y %H:%M")
rentalQ154 <- read.csv("HealthyRideRentals 2015 Q4.csv", na.strings= c("999", "NA", " ", ""))
View(rentalQ154)
rentalQ154$StartTime <- strptime(rentalQ154$StartTime)
rentalQ154$StartTime <- strptime(rentalQ154$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ154$StartTime <- strptime(rentalQ154$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ154$StopTime <- strptime(rentalQ154$StopTime, format="%Y-%m-%d %H:%M:%S")
rentalQ161 <- read.csv("HealthyRide Rentals 2016 Q1.csv", na.strings= c("999", "NA", " ", ""))
View(rentalQ161)
rentalQ161$StartTime <- strptime(rentalQ161$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ161$StopTime <- strptime(rentalQ161$StopTime, format="%Y-%m-%d %H:%M:%S")
rentalQ161$StartTime <- strptime(rentalQ161$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ161 <- read.csv("HealthyRide Rentals 2016 Q1.csv", na.strings= c("999", "NA", " ", ""))
rentalQ161$StartTime <- strptime(rentalQ161$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ161$StopTime <- strptime(rentalQ161$StopTime, format="%Y-%m-%d %H:%M:%S")
rentalQ154$StartTime <- strptime(rentalQ154$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ161 <- read.csv("HealthyRide Rentals 2016 Q1.csv", na.strings= c("999", "NA", " ", ""))
rentalQ161 <- read.csv("HealthyRide Rentals 2016 Q1.csv", na.strings= c("999", "NA", " ", ""))
## Make sure they have the same colunm names
names(rentalQ161) <- c(names(rentalQ153))
rentalQ161$StartTime <- strptime(rentalQ161$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ161$StartTime <- strptime(rentalQ161$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ161$StopTime <- strptime(rentalQ161$StopTime, format="%Y-%m-%d %H:%M:%S")
## binding the data together
bike <- rbind(rentalQ153,rentalQ154,rentalQ161)
bike$TripId <- as.factor(bike$TripId)
bike$BikeId <- as.factor(bike$BikeId)
bike$FromStationId <- as.factor(bike$FromStationId)
bike$ToStationId <- as.factor(bike$ToStationId)
## binding the data together
bike <- rbind(rentalQ153,rentalQ154,rentalQ161)
bike$TripId <- as.factor(bike$TripId)
bike$BikeId <- as.factor(bike$BikeId)
bike$FromStationId <- as.factor(bike$FromStationId)
bike$ToStationId <- as.factor(bike$ToStationId)
## binding the data together
bike <- rbind(rentalQ153,rentalQ154,rentalQ161)
bike$TripId <- as.factor(bike$TripId)
bike$BikeId <- as.factor(bike$BikeId)
bike$FromStationId <- as.factor(bike$FromStationId)
bike$ToStationId <- as.factor(bike$ToStationId)
str(rentalQ153)
rentalQ153$StartTime$year
bike <- bike %>% mutate(
year = as.factor(StartTime$year)
)
bike <- bike %>% mutate(
year = format(as.factor(StartTime), format = StartTime$year)
)
bike <- bike %>% mutate(
year = format(as.POSIXct(StartTime), format = "%Y"),
month = format(as.POSIXct(StartTime), format = "%m"),
day = format(as.POSIXct(StartTime), format = "%d"),
hour = format(as.POSIXct(StartTime), format= "%H")
)
set_up_features <- function(df) {
df$datetime <- strptime(df$datetime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$datetime$hour)
df$wday <- as.factor(df$datetime$wday)
df$month <- as.factor(df$datetime$mon)
df$year <- as.factor(df$datetime$year + 1900)
# ... smth else ...
df
}
bike <- set_up_features(bike)
set_up_features <- function(df) {
df$StartTime <- strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$StartTime$hour)
df$wday <- as.factor(df$StartTime$wday)
df$month <- as.factor(df$StartTime$mon)
df$year <- as.factor(df$StartTime$year + 1900)
# ... smth else ...
df
}
bike <- set_up_features(bike)
View(bike)
strptime("2015-06-30 23:59:00", format="%Y-%m-%d %H:%M:%S")
mine <- strptime("2015-06-30 23:59:00", format="%Y-%m-%d %H:%M:%S")
mine
mine$year
mine$month
mine$mon
justATech <- "2015-06-30 23:59:00"
justATech$mon
mine$mon
justATech$mon
justATech
justATech$year
mine <- strptime("2015-07-01 07:35:00", format="%Y-%m-%d %H:%M:%S")
mine$mon
mine$wday
setwd()
setwd("./")
getwd()
setwd(./Users/Abdulaziz)
setwd("./Users/Abdulaziz")
setwd("/Users/Abdulaziz")
setwd("/Users/Abdulaziz/Downloads/")
library(caret)
source('utils.R')
test_classes = c(
"character",   # datetime
"factor",      # season
"factor",      # holiday
"factor",      # workingday
"factor",      # weather
"numeric",     # temp
"numeric",     # atemp
"integer",     # humidity
"numeric"      # windspeed
)
train_classes = c(test_classes, c("integer",     # casual
"integer",     # registered
"integer"))    # count
train_raw <- read.csv("train.csv", colClasses = train_classes)
library(caret)
source('utils.R')
test_classes = c(
"character",   # datetime
"factor",      # season
"factor",      # holiday
"factor",      # workingday
"factor",      # weather
"numeric",     # temp
"numeric",     # atemp
"integer",     # humidity
"numeric"      # windspeed
)
train_classes = c(test_classes, c("integer",     # casual
"integer",     # registered
"integer"))    # count
train_raw <- read.csv("train.csv", colClasses = train_classes)
set_up_features <- function(df) {
df$datetime <- strptime(df$datetime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$datetime$hour)
df$wday <- as.factor(df$datetime$wday)
df$month <- as.factor(df$datetime$mon)
df$year <- as.factor(df$datetime$year + 1900)
# ... smth else ...
df
}
View(train_raw)
train_raw <- set_up_features(train_raw)
unclass(train_raw$datetime)
unclass(train_raw$datetime[1])
setwd("./Documents/Master/Data Mining/Project/")
setwd("./Documents/Master/Data Mining/Project/")
setwd("Users/Abdulaziz/Documents/Master/Data Mining/Project/")
setwd("Users/Abdulaziz/Documents/Master/Data Mining/Project/")
getwd()
setwd("/")
setwd("Users/Abdulaziz/Documents/Master/Data Mining/Project/")
### Get the data
setwd("./data/")
library(lubridate)
library(dplyr)
## Read The data
### stations data
stations <- read.csv("HealthyRideStations2015.csv")
## 2015 Q3
rentalQ153 <- read.csv("HealthyRideRentals 2015 Q3.csv",na.strings= c("999", "NA", " ", ""))
### Change the data
rentalQ153$StartTime <- strptime(rentalQ153$StartTime, format="%m/%d/%Y %H:%M")
rentalQ153$StopTime <- strptime(rentalQ153$StopTime, format="%m/%d/%Y %H:%M")
# rentalQ153$StartTime <- as.POSIXct(rentalQ153$StartTime, format="%m/%d/%Y %H:%M")
# rentalQ153$StopTime <- as.POSIXct(rentalQ153$StopTime, format="%m/%d/%Y %H:%M")
## 2015 Q4
## Converting from xls to csv
# require(gdata)
# ## install support for xlsx files
# installXLSXsupport()
# excelFile <- ("./HealthyRideRentals 2015 Q4.xlsx")
# ## note that the perl scripts that gdata uses do not cope well will tilde expansion
# ## on *nix machines. So use the full path.
# numSheets <- sheetCount(excelFile, verbose=TRUE)
#
# for ( i in 1:numSheets) {
#   mySheet <- read.xls(excelFile, sheet=i)
#   write.csv(mySheet, file=paste(i, "csv", sep="."), row.names=FALSE)
# }
rentalQ154 <- read.csv("HealthyRideRentals 2015 Q4.csv", na.strings= c("999", "NA", " ", ""))
rentalQ154$StartTime <- strptime(rentalQ154$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ154$StopTime <- strptime(rentalQ154$StopTime, format="%Y-%m-%d %H:%M:%S")
# rentalQ154$StartTime <- as.POSIXct(rentalQ154$StartTime)
# rentalQ154$StopTime <- as.POSIXct(rentalQ154$StopTime)
## 2016 Q1
## Converting from xls to csv
# require(gdata)
# ## install support for xlsx files
# installXLSXsupport()
# excelFile <- ("./HealthyRide Rentals 2016 Q1.xlsx")
# ## note that the perl scripts that gdata uses do not cope well will tilde expansion
# ## on *nix machines. So use the full path.
#
#
# mySheet <- read.xls(excelFile)
# write.csv(mySheet, file=paste("HealthyRide Rentals 2016 Q1","csv", sep="."), row.names=FALSE)
rentalQ161 <- read.csv("HealthyRide Rentals 2016 Q1.csv", na.strings= c("999", "NA", " ", ""))
## Make sure they have the same colunm names
names(rentalQ161) <- c(names(rentalQ153))
rentalQ161$StartTime <- strptime(rentalQ161$StartTime, format="%Y-%m-%d %H:%M:%S")
rentalQ161$StopTime <- strptime(rentalQ161$StopTime, format="%Y-%m-%d %H:%M:%S")
# rentalQ161$Starttime <- as.POSIXct(rentalQ161$Starttime,format="%Y-%m-%d %H:%M:%S")
# rentalQ161$Stoptime <- as.POSIXct(rentalQ161$Stoptime,format="%Y-%m-%d %H:%M:%S")
## binding the data together
bike <- rbind(rentalQ153,rentalQ154,rentalQ161)
bike$TripId <- as.factor(bike$TripId)
bike$BikeId <- as.factor(bike$BikeId)
bike$FromStationId <- as.factor(bike$FromStationId)
bike$ToStationId <- as.factor(bike$ToStationId)
## Splitting the date
# bike <- bike %>% mutate(
#   year = format(as.POSIXct(StartTime), format = "%Y"),
#   month = format(as.POSIXct(StartTime), format = "%m"),
#   day = format(as.POSIXct(StartTime), format = "%d"),
#   hour = format(as.POSIXct(StartTime), format= "%H")
# )
set_up_features <- function(df) {
df$StartTime <- strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$StartTime$hour)
df$wday <- as.factor(df$StartTime$wday)
df$month <- as.factor(df$StartTime$mon)
df$year <- as.factor(df$StartTime$year + 1900)
# ... smth else ...
df
}
bike <- set_up_features(bike)
## Make a summeary for the missing values
na_data <- sapply(bike, function(x) sum(length(which(is.na(x)))))
na_data
bike$FromStationName[which(is.na(bike$FromStationId))]
bike$FromStationId[which(is.na(bike$FromStationName))]
## I guss we should just drop them
View(bike)
set_up_features <- function(df) {
df$StartTime <- strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$StartTime$hour)
df$wday <- as.factor(df$StartTime$wday)
df$month <- as.factor(df$StartTime$mon+1)
df$year <- as.factor(df$StartTime$year + 1900)
# ... smth else ...
df
}
bike <- set_up_features(bike)
table(bike$hour)
library(dplyr)
View(bike)
bike1 <- select(bike, wday == 3)
bike1 <- filter(bike, wday = 3)
bike1 <- filter(bike, wday == 3)
bike1 <- filter(bike, TripId=11714480)
bike1 <- filter(bike, TripId==11714480)
bike1 <- filter(bike, TripId=="
11714480")
bike1 <- filter(bike, TripId=="
11714480")
filter(bike, TripId == "11714480")
summary(bike)
str(bike)
filter(bike, TripId=="11714480")
str(bike)
str(bike)
filter(bike, TripId=="11714480")
bike1 <- subset(bike, TripId == "11714480")
View(bike1)
bike1 <- subset(bike, wday == 3)
bike1 <- subset(bike, wday == 3 & month == 7 & year == 2015)
View(bike)
bike1 <- subset(bike, wday == 3)
bike1 <- subset(bike, wday == 3 & month == 7 & year == 2015)
View(bike1)
table(bike1$StartTime)
str(bike1)
table(as.factor(bike1$StartTime))
table(bike1$wday)
set_up_features <- function(df) {
df$StartTime <- strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$StartTime$hour)
df$day <- as.factor(df$StartTime$day)
df$wday <- as.factor(df$StartTime$wday)
df$month <- as.factor(df$StartTime$mon+1) ## starts from 0
df$year <- as.factor(df$StartTime$year + 1900)
# ... smth else ...
df
}
bike <- set_up_features(bike)
set_up_features <- function(df) {
df$StartTime <- strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$StartTime$hour)
# df$day <- as.factor(df$StartTime$day)
df$wday <- as.factor(df$StartTime$wday)
df$month <- as.factor(df$StartTime$mon+1) ## starts from 0
df$year <- as.factor(df$StartTime$year + 1900)
# ... smth else ...
df
}
bike <- set_up_features(bike)
set_up_features <- function(df) {
df$StartTime <- strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$StartTime$hour)
df$day <- format(as.factor(df$StartTime), format = "%d")
df$wday <- as.factor(df$StartTime$wday)
df$month <- as.factor(df$StartTime$mon+1) ## starts from 0
df$year <- as.factor(df$StartTime$year + 1900)
# ... smth else ...
df
}
bike <- set_up_features(bike)
set_up_features <- function(df) {
df$StartTime <- strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$StartTime$hour)
df$day <- format(StartTime, format = "%d")
df$wday <- as.factor(df$StartTime$wday)
df$month <- as.factor(df$StartTime$mon+1) ## starts from 0
df$year <- as.factor(df$StartTime$year + 1900)
# ... smth else ...
df
}
bike <- set_up_features(bike)
set_up_features <- function(df) {
df$StartTime <- strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$StartTime$hour)
df$day <- format(df$StartTime, format = "%d")
df$wday <- as.factor(df$StartTime$wday)
df$month <- as.factor(df$StartTime$mon+1) ## starts from 0
df$year <- as.factor(df$StartTime$year + 1900)
# ... smth else ...
df
}
bike <- set_up_features(bike)
set_up_features <- function(df) {
df$StartTime <- strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
df$day <- as.factor(format(df$StartTime, format = "%d"))
df$hour <- as.factor(df$StartTime$hour)
df$wday <- as.factor(df$StartTime$wday)
df$month <- as.factor(df$StartTime$mon+1) ## starts from 0
df$year <- as.factor(df$StartTime$year + 1900)
# ... smth else ...
df
}
bike <- set_up_features(bike)
strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
mine <- strptime("2015-06-30 23:59:00
", format="%Y-%m-%d %H:%M:%S")
mine
unclass(mine)
set_up_features <- function(df) {
df$StartTime <- strptime(df$StartTime, format="%Y-%m-%d %H:%M:%S")
df$hour <- as.factor(df$StartTime$hour)
df$day <-  as.factor(df$StartTime$mday)
df$wday <- as.factor(df$StartTime$wday)
df$month <- as.factor(df$StartTime$mon+1) ## starts from 0
df$year <- as.factor(df$StartTime$year + 1900)
df
}
bike <- set_up_features(bike)
select(bike, day=="1")
select(bike, day==1)
select(bike, day=1)
remove(bike1)
bike1 <- select(bike, day= 1 & month = 7)
bike1 <- select(bike, day= 1 )
bike1 <- select(bike, (day= 1 & month = 7 ))
bike1 <- select(bike, (day= 1 && month = 7 ))
View(bike)
bike1 <- filter(bike, month = 7, day = 1)
bike1 <- filter(bike, month = 7)
bike1 <- filter(bike, day = 7)
bike1 <- filter(bike, day = 1)
str(bike)
bike1 <- filter(bike, day = "1")
bike1 <- filter(bike, day == "1")
bike1 <- filter(bike, day == 1)
bike1 <- select(bike, day == 1)
bike1 <- select(bike, day = 1)
View(bike1)
bike1 <- select(bike, day = 1)
bike1 <- filter(bike, day = 1)
bike %>% select(TripId) %>% filter(day = 1)
bike %>% select(TripId) %>% filter(day == 1)
bike %>% select(TripId) %>% filter(day == "1")
bike %>% select(TripId) %>% filter(day !=1)
filter(bike, day==1)
filter(bike, TripID == "11714480")
filter(bike, TripID == 11714480)
bike %>% select(TripId) %>% filter(TripID == 11714480)
bike %>% select(TripId) %>% filter(TripId == 11714480)
bike %>% filter(TripId == 11714480)
bike %>% select(TripId) %>% filter(day = 1)
bike %>% select(TripId) %>% filter(day == 1
bike %>% select(TripId) %>% filter(day == 1)
bike %>% select(TripId) %>% filter(day == 1)
bike %>% select(TripId) %>% filter(TripDuration > 566)
bike %>% select(TripId) %>% filter(TripDuration == 566)
bike$TripDuration
select(bike, TripId) %>% filter(TripDuration == 566)
select(bike, TripId) %>% filter(bike,TripDuration == 566)
bike$TripDurationnames
names(bike)
filter(bike, FromStationId == "1001")
select(bike, TripId) %>% filter(bike, FromStationId == "1001")
select(bike, TripId) %>% filter(FromStationId == "1001")
select(bike, TripId)
select(bike, TripId) %>% filter(FromStationId == "1001")
select(bike, TripId) %>% filter(FromStationId == 1001)
bike %>% select(TripId) %>% filter(FromStationId == 1001)
bike %>% filter(FromStationId == 1001) %>% select(TripId) %>%
ff
bike %>% filter(FromStationId == 1001) %>% select(TripId)
library(nycflights13)
install.packages(nycflights13)
install.packages("nycflights13")
library(nycflights13)
dim(flights)
View(flights)
flights %>% select(year, month) %>% filter(arr_time > 500)
flights %>%
group_by(year, month, day) %>%
select(arr_delay, dep_delay) %>%
summarise(
arr = mean(arr_delay, na.rm = TRUE),
dep = mean(dep_delay, na.rm = TRUE)
) %>%
filter(arr > 30 | dep > 30)
flights %>%
group_by(year, month, day) %>%
select(arr_delay, dep_delay) %>%
filter( arr_delay >2)
flights %>%
group_by(year, month, day) %>%
select(arr_delay, dep_delay) %>%
filter( arr_time >2)
str(flights)
flights %>%
group_by(year, month, day) %>%
select(arr_delay, dep_delay) %>%
filter( air_time > 830)
flights %>%
group_by(year, month, day) %>%
select(arr_delay, dep_delay) %>%
filter( arr_delay > 830)
flights %>%
group_by(year, month, day) %>%
select(arr_delay, dep_delay) %>%
filter( day > 2)
flights %>%
group_by(year, month, day) %>%
select(arr_delay, dep_delay) %>%
filter( day > 2)
flights %>%
group_by(year, month, day) %>%
select(arr_delay, dep_delay, arr_time) %>%
filter( arr_time > 2)
flights %>%
group_by(year, month, day) %>%
select(arr_delay, dep_delay) %>%
filter( arr_time > 2)
bike %>% select(TripId,FromStationId) %>% filter(FromStationId == 1001)
